name: Android CI

on: [push]

jobs:
    build:
        runs-on: ubuntu-latest

        steps:
        - name: Checkout code
          uses: actions/checkout

        - name: Set up JDK 11
          uses: actions/setup-java
          with:
            distribution: 'adopt'
            java-version: '11'

        - name: Cache Gradle packages
          uses: actions/cache
          with:
            path: |
                ~/.gradle/caches
                ~/.gradle/wrapper
            key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
            restore-keys: |
                ${{ runner.os }}-gradle

        - name: Build with Gradle
          run: ./gradlew build

        - name: Upload APK
          uses: actions/upload-artifact
          with:
            name: app-apk
            path: app/build/outputs/apk/**/*.apk